<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <title>ç®€åŒ–ç‰ˆå›¾ç‰‡é€‰æ‹©éªŒè¯ç  Demo</title>
  <style>
    body{font-family:-apple-system, BlinkMacSystemFont, Roboto, Arial;display:flex;align-items:center;justify-content:center;min-height:100vh;background:#f3f4f6;margin:0;padding:12px}
    .card{width:100%;max-width:360px;background:white;padding:18px;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,0.1);}
    h1{font-size:18px;margin:0 0 10px}
    .desc{font-size:16px;color:#444;margin-bottom:12px;display:flex;align-items:center;gap:6px;flex-wrap:wrap}
    #targetIcon{font-size:26px} /* æ”¾å¤§çš„ç›®æ ‡ emoji */
    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-bottom:12px}
    .tile{aspect-ratio:1/1;font-size:40px;display:flex;align-items:center;justify-content:center;border-radius:8px;cursor:pointer;transition:.15s;border:2px solid transparent;user-select:none}
    .tile:active{transform:scale(0.95)}
    .tile:hover{background:#f9fafb}
    .tile.selected{border:2px solid #3b82f6;background:#eff6ff}
    .controls{display:flex;gap:8px}
    button{flex:1;padding:10px;border-radius:8px;border:0;cursor:pointer;font-weight:600;font-size:15px}
    button.primary{background:#3b82f6;color:white}
    button.ghost{background:#f3f4f6;color:#333}
    .status{margin-top:10px;font-weight:600}
  </style>
</head>
<body>
  <div class="card">
    <h1>ç®€åŒ–ç‰ˆéªŒè¯ç </h1>
    <p class="desc">è¯·é€‰æ‹©æ‰€æœ‰ <span id="targetIcon"></span><strong id="targetLabel"></strong>ã€‚</p>

    <div class="grid" id="grid"></div>

    <div class="controls">
      <button class="ghost" id="resetBtn">å†è¯•ä¸€æ¬¡</button>
      <button class="primary" id="verifyBtn">éªŒè¯</button>
      
    </div>

    <div class="status" id="status"></div>
    <div class="status" id="timeStatus"></div>
    <div class="status" id="stats"></div>
  </div>

  <script>
    (function(){
      const gridEl = document.getElementById('grid');
      const statusEl = document.getElementById('status');
      const timeStatus = document.getElementById('timeStatus');
      const statsEl = document.getElementById('stats');
      const verifyBtn = document.getElementById('verifyBtn');
      const resetBtn = document.getElementById('resetBtn');
      const targetLabel = document.getElementById('targetLabel');
      const targetIconEl = document.getElementById('targetIcon');

      const ICONS = [
        {icon:'ğŸš²',label:'è‡ªè¡Œè½¦'},
        {icon:'âœˆï¸',label:'é£æœº'},
        {icon:'ğŸš—',label:'æ±½è½¦'},
        {icon:'ğŸšŒ',label:'å…¬äº¤è½¦'},
        {icon:'ğŸš•',label:'å‡ºç§Ÿè½¦'},
        {icon:'ğŸš¤',label:'å°èˆ¹'},
        {icon:'ğŸš‚',label:'ç«è½¦'},
        {icon:'ğŸ¶',label:'å°ç‹—'},
        {icon:'ğŸ±',label:'å°çŒ«'},
        {icon:'ğŸ¼',label:'ç†ŠçŒ«'},
        {icon:'ğŸ',label:'è‹¹æœ'},
        {icon:'ğŸŒ',label:'é¦™è•‰'},
        {icon:'ğŸ‡',label:'è‘¡è„'},
        {icon:'ğŸ ',label:'æˆ¿å­'},
        {icon:'ğŸ¢',label:'å¤§æ¥¼'},
        {icon:'ğŸŒ³',label:'æ ‘'},
        {icon:'ğŸŒ¸',label:'èŠ±'},
        {icon:'ğŸ“š',label:'ä¹¦ç±'},
        {icon:'ğŸ’»',label:'ç”µè„‘'},
        {icon:'ğŸš¦',label:'çº¢ç»¿ç¯'}
      ];

      let target;
      let correctIds = new Set();
      let tiles = [];
      let startTime;

      // stats
      let times = [];
      let attempts = 0;
      let successes = 0;

      function shuffle(arr){ return arr.sort(()=>Math.random()-0.5); }

      function newChallenge(){
        gridEl.innerHTML = '';
        tiles = [];
        correctIds.clear();
        statusEl.textContent = '';
        timeStatus.textContent = '';
        statusEl.style.color = '';

        target = ICONS[Math.floor(Math.random()*ICONS.length)];
        targetIconEl.textContent = target.icon;
        targetLabel.textContent = target.label;

        let pool = [];
        pool.push(target.icon, target.icon);
        while(pool.length<9){ pool.push(ICONS[Math.floor(Math.random()*ICONS.length)].icon); }
        pool = shuffle(pool);

        pool.forEach((icon,idx)=>{
          const t = document.createElement('div');
          t.className = 'tile';
          t.textContent = icon;
          t.dataset.icon = icon;
          t.addEventListener('click',()=>{ t.classList.toggle('selected'); });
          gridEl.appendChild(t);
          tiles.push(t);
          if(icon===target.icon) correctIds.add(idx);
        });

        startTime = performance.now();
      }

      function verify(){
        const selected = new Set();
        tiles.forEach((t,i)=>{ if(t.classList.contains('selected')) selected.add(i); });
        const endTime = performance.now();
        const duration = ((endTime - startTime)/1000).toFixed(2);
        timeStatus.textContent = `æäº¤è€—æ—¶: ${duration}s`;

        attempts++;

        if(selected.size===0){
          statusEl.textContent = 'è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªæ ¼å­ã€‚';
          statusEl.style.color = '#dc2626';
          return;
        }
        if(setEqual(selected,correctIds)){
          statusEl.textContent = 'éªŒè¯æˆåŠŸ âœ…';
          statusEl.style.color = '#16a34a';
          successes++;
          times.push(parseFloat(duration));
          updateStats();
        } else {
          statusEl.textContent = 'éªŒè¯å¤±è´¥ï¼Œè¯·é‡è¯•ã€‚';
          statusEl.style.color = '#dc2626';
          times.push(parseFloat(duration));
          updateStats();
          setTimeout(newChallenge,300);
        }
      }

      function updateStats(){
        if(times.length===0) return;
        const avg = (times.reduce((a,b)=>a+b,0)/times.length).toFixed(2);
        const best = Math.min(...times).toFixed(2);
        const worst = Math.max(...times).toFixed(2);
        const successRate = ((successes/attempts)*100).toFixed(1);
        statsEl.textContent = `å¹³å‡è€—æ—¶: ${avg}s | æœ€å¿«: ${best}s | æœ€æ…¢: ${worst}s | æˆåŠŸç‡: ${successRate}%`;
      }

      function setEqual(a,b){
        if(a.size!==b.size) return false;
        for(const x of a){ if(!b.has(x)) return false; }
        return true;
      }

      verifyBtn.addEventListener('click',verify);
      resetBtn.addEventListener('click',newChallenge);

      newChallenge();
    })();
  </script>
</body>
</html>
